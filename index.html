<!DOCTYPE html>
<html lang="en">
<head>
    <base target="_self">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HazardGuard Nepal - Disaster Awareness & Preparedness</title>
    <meta name="description" content="Disaster awareness and preparedness website for Nepal with real-time alerts and emergency information">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#8b5a2b">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Leaflet CSS for Interactive Map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <!-- Leaflet Control Layers CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-bg: #f8f5f0;
            --secondary-bg: #f0ebe3;
            --card-bg: #ffffff;
            --text-primary: #3c2f2f;
            --text-secondary: #6b5b4c;
            --accent-brown: #8b5a2b;
            --accent-orange: #d2691e;
            --accent-tan: #d2b48c;
            --accent-red: #c53030;
            --accent-green: #38a169;
            --accent-blue: #3182ce;
            --accent-purple: #805ad5;
            --border-color: #d4c9ba;
            --shadow-light: rgba(139, 90, 43, 0.08);
            --shadow-medium: rgba(139, 90, 43, 0.15);
            --aqi-good: #00e400;
            --aqi-moderate: #ffff00;
            --aqi-sensitive: #ff7e00;
            --aqi-unhealthy: #ff0000;
            --aqi-very-unhealthy: #8f3f97;
            --aqi-hazardous: #7e0023;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--primary-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .floating-nav {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50px;
            padding: 10px 20px;
            z-index: 1000;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 0;
            align-items: center;
        }

        .floating-nav button {
            padding: 12px 28px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'DM Sans', sans-serif;
            font-size: 14px;
            border-radius: 30px;
            white-space: nowrap;
        }

        .floating-nav button:hover {
            background: rgba(139, 90, 43, 0.1);
            color: var(--accent-brown);
        }

        .floating-nav button.active {
            background: var(--accent-brown);
            color: white;
            box-shadow: 0 4px 12px rgba(139, 90, 43, 0.2);
        }

        .nav-divider {
            color: rgba(212, 201, 186, 0.5);
            font-weight: 300;
            padding: 0 8px;
        }

        .hero-section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            position: relative;
            overflow: hidden;
            background: linear-gradient(rgba(60, 47, 47, 0.7), rgba(60, 47, 47, 0.7)), 
                        url('https://img.apmcdn.org/11ad388cf3255bb15b9d6d68ab4c5088c908a0cd/uncropped/c51be6-20120706-flood-cleanup4.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            padding: 0 20px;
        }

        .hero-content {
            max-width: 900px;
            position: relative;
            z-index: 2;
            padding: 40px;
        }

        .hero-title {
            font-size: 72px;
            font-weight: 700;
            margin-bottom: 32px;
            color: white;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            letter-spacing: -1px;
            line-height: 1.1;
            font-family: 'Bodoni MT', 'Times New Roman', serif;
        }

        .hero-subtitle {
            font-size: 20px;
            line-height: 1.8;
            margin-bottom: 48px;
            color: rgba(255, 255, 255, 0.9);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            font-weight: 400;
            letter-spacing: 0.2px;
            text-align: center;
        }

        .discover-btn {
            display: inline-block;
            color: white;
            font-size: 18px;
            font-weight: 600;
            text-decoration: none;
            padding: 16px 0;
            position: relative;
            background: none;
            border: none;
            cursor: pointer;
        }

        .discover-btn::after {
            content: '';
            position: absolute;
            bottom: 12px;
            left: 0;
            width: 100%;
            height: 2px;
            background: white;
            transform: scaleX(0.7);
            transition: transform 0.3s;
        }

        .discover-btn:hover::after {
            transform: scaleX(1);
        }

        main {
            position: relative;
            z-index: 1;
        }

        .tab-content {
            display: none;
            animation: fadeInUp 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 24px;
        }

        .section-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            padding: 48px;
            margin: 60px auto 40px;
            box-shadow: 0 8px 32px var(--shadow-light);
        }

        .section-title {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 32px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--accent-tan);
            color: var(--accent-brown);
            position: relative;
        }

        .content-text {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 16px;
        }

        .map-wrapper {
            border: 1px solid var(--border-color);
            border-radius: 20px;
            overflow: hidden;
            margin: 40px 0;
            background: var(--card-bg);
            box-shadow: 0 8px 32px var(--shadow-light);
        }

        .map-header {
            background: var(--card-bg);
            padding: 20px 28px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .map-header h3 {
            font-size: 18px;
            font-weight: 700;
        }

        .map-controls {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            width: 100%;
            flex-wrap: wrap;
        }

        .map-btn {
            padding: 8px 16px;
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .map-btn:hover {
            background: rgba(139, 90, 43, 0.08);
            color: var(--text-primary);
        }

        .map-btn.active {
            background: var(--accent-brown);
            color: white;
            border-color: var(--accent-brown);
        }

        .map-container {
            position: relative;
            padding: 24px;
        }

        .map-display {
            position: relative;
            width: 100%;
            height: 500px;
            overflow: hidden;
            border-radius: 16px;
            border: 1px solid var(--border-color);
        }

        #interactive-map {
            width: 100%;
            height: 100%;
            border-radius: 16px;
        }

        .alert-cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 24px;
            margin-top: 40px;
        }

        .alert-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 30px;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .alert-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 32px var(--shadow-medium);
        }

        .alert-card.high-risk {
            border-color: var(--accent-red);
            background: linear-gradient(135deg, rgba(197, 48, 48, 0.05), rgba(197, 48, 48, 0.02));
        }

        .alert-card.medium-risk {
            border-color: var(--accent-orange);
            background: linear-gradient(135deg, rgba(210, 105, 30, 0.05), rgba(210, 105, 30, 0.02));
        }

        .alert-card.low-risk {
            border-color: var(--accent-green);
            background: linear-gradient(135deg, rgba(56, 161, 105, 0.05), rgba(56, 161, 105, 0.02));
        }

        .alert-card.normal {
            border-color: var(--accent-blue);
            background: linear-gradient(135deg, rgba(49, 130, 206, 0.05), rgba(49, 130, 206, 0.02));
        }

        .alert-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .alert-icon {
            width: 60px;
            height: 60px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
        }

        .alert-card.high-risk .alert-icon {
            background: linear-gradient(135deg, var(--accent-red), #e53e3e);
        }

        .alert-card.medium-risk .alert-icon {
            background: linear-gradient(135deg, var(--accent-orange), #ed8936);
        }

        .alert-card.low-risk .alert-icon {
            background: linear-gradient(135deg, var(--accent-green), #48bb78);
        }

        .alert-card.normal .alert-icon {
            background: linear-gradient(135deg, var(--accent-blue), #4299e1);
        }

        .alert-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .alert-card.high-risk .alert-badge {
            background: rgba(197, 48, 48, 0.15);
            color: var(--accent-red);
        }

        .alert-card.medium-risk .alert-badge {
            background: rgba(210, 105, 30, 0.15);
            color: var(--accent-orange);
        }

        .alert-card.low-risk .alert-badge {
            background: rgba(56, 161, 105, 0.15);
            color: var(--accent-green);
        }

        .alert-card.normal .alert-badge {
            background: rgba(49, 130, 206, 0.15);
            color: var(--accent-blue);
        }

        .alert-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .alert-description {
            color: var(--text-secondary);
            font-size: 15px;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .alert-actions {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(212, 201, 186, 0.3);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .alert-click-hint {
            font-size: 13px;
            color: var(--accent-brown);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .alert-click-hint i {
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateX(0);
            }
            50% {
                transform: translateX(5px);
            }
        }

        .realtime-widgets {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 30px;
        }

        .realtime-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 24px;
            transition: all 0.3s;
        }

        .realtime-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px var(--shadow-medium);
        }

        .realtime-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .realtime-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent-brown);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .realtime-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-live {
            background: rgba(56, 161, 105, 0.1);
            color: var(--accent-green);
        }

        .status-updating {
            background: rgba(210, 105, 30, 0.1);
            color: var(--accent-orange);
        }

        .realtime-value {
            font-size: 32px;
            font-weight: 700;
            margin: 10px 0;
            line-height: 1;
        }

        .realtime-unit {
            font-size: 14px;
            color: var(--text-secondary);
            margin-left: 4px;
        }

        .realtime-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 15px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .detail-value {
            font-size: 16px;
            font-weight: 600;
        }

        .realtime-source {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
            font-size: 11px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .aqi-indicator {
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(90deg, 
                var(--aqi-good) 0%, 
                var(--aqi-moderate) 20%, 
                var(--aqi-sensitive) 40%, 
                var(--aqi-unhealthy) 60%, 
                var(--aqi-very-unhealthy) 80%, 
                var(--aqi-hazardous) 100%);
            margin: 10px 0;
            position: relative;
        }

        .aqi-marker {
            position: absolute;
            top: -4px;
            width: 16px;
            height: 16px;
            background: white;
            border: 2px solid var(--text-primary);
            border-radius: 50%;
            transform: translateX(-50%);
        }

        .flood-level-indicator {
            height: 8px;
            border-radius: 4px;
            background: linear-gradient(90deg, 
                var(--accent-green) 0%, 
                var(--accent-blue) 33%, 
                var(--accent-orange) 66%, 
                var(--accent-red) 100%);
            margin: 10px 0;
            position: relative;
        }

        .flood-marker {
            position: absolute;
            top: -4px;
            width: 16px;
            height: 16px;
            background: white;
            border: 2px solid var(--text-primary);
            border-radius: 50%;
            transform: translateX(-50%);
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
        }

        .legend-color {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 12px;
        }

        .weather-widget-mapping {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 24px;
            margin-top: 40px;
            box-shadow: 0 8px 32px var(--shadow-light);
        }

        .weather-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .weather-location {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .weather-location i {
            color: var(--accent-brown);
            font-size: 20px;
        }

        .weather-location h4 {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent-brown);
        }

        .weather-main {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .weather-temp {
            font-size: 48px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .weather-icon {
            font-size: 64px;
            color: var(--accent-blue);
            animation: floatWeather 3s ease-in-out infinite;
        }

        @keyframes floatWeather {
            0%, 100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .weather-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .weather-detail {
            text-align: center;
        }

        .weather-detail-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 5px;
        }

        .weather-detail-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .emergency-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 40px;
        }

        .emergency-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 36px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .emergency-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 16px 48px var(--shadow-medium);
        }

        .emergency-icon-wrapper {
            width: 80px;
            height: 80px;
            margin: 0 auto 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
        }

        .emergency-number {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 20px;
        }

        .emergency-number i {
            font-size: 20px;
        }

        .emergency-number span {
            font-size: 40px;
            font-weight: 800;
        }

        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 32px;
            margin-top: 40px;
        }

        .team-member {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 32px;
            text-align: center;
            transition: all 0.3s;
        }

        .team-member:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 32px var(--shadow-medium);
        }

        .member-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            color: white;
            font-weight: 600;
            overflow: hidden;
            border: 3px solid var(--accent-tan);
        }

        .member-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center center;
        }

        footer {
            padding: 60px 0 40px;
            border-top: 1px solid var(--border-color);
            margin-top: 80px;
            background: var(--secondary-bg);
            text-align: center;
        }

        .footer-content h3 {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 16px;
            color: var(--accent-brown);
        }

        .footer-content > p {
            color: var(--text-secondary);
            max-width: 600px;
            margin: 0 auto 32px;
        }

        .checklist-container {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 32px;
            margin-top: 40px;
        }

        .checklist-item {
            display: flex;
            align-items: center;
            padding: 16px;
            background: var(--secondary-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            margin-bottom: 8px;
            transition: all 0.3s;
        }

        .checklist-item:hover {
            background: rgba(139, 90, 43, 0.05);
            border-color: var(--accent-tan);
        }

        .checklist-item input[type="checkbox"] {
            margin-right: 16px;
            width: 20px;
            height: 20px;
            accent-color: var(--accent-brown);
        }

        .location-buttons {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .location-btn {
            padding: 12px 20px;
            background: var(--accent-blue);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }

        .location-btn.secondary {
            background: transparent;
            color: var(--accent-brown);
            border: 2px solid var(--accent-brown);
        }

        .location-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

        .location-btn.secondary:hover {
            background: rgba(139, 90, 43, 0.05);
        }

        .refresh-btn {
            padding: 8px 16px;
            background: var(--accent-blue);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            font-size: 14px;
        }

        .refresh-btn:hover {
            background: var(--accent-brown);
            transform: translateY(-2px);
        }

        .refresh-btn.updating {
            background: var(--accent-orange);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }

        .alert-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 24px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--accent-brown);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: color 0.3s;
        }

        .modal-close:hover {
            color: var(--accent-red);
        }

        .modal-body {
            padding: 24px;
        }

        .preparedness-list {
            list-style: none;
            padding: 0;
        }

        .preparedness-list li {
            padding: 12px 0;
            border-bottom: 1px solid rgba(212, 201, 186, 0.3);
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .preparedness-list li:last-child {
            border-bottom: none;
        }

        .preparedness-list li i {
            color: var(--accent-green);
            margin-top: 2px;
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 48px;
            }
            
            .hero-subtitle {
                font-size: 18px;
                padding: 0 10px;
            }
            
            .floating-nav {
                padding: 8px 16px;
                top: 16px;
                backdrop-filter: blur(25px);
            }
            
            .floating-nav button {
                padding: 10px 16px;
                font-size: 13px;
            }
            
            .nav-divider {
                display: none;
            }
            
            .section-card {
                padding: 28px 20px;
            }
            
            .section-title {
                font-size: 28px;
            }
            
            .location-buttons {
                flex-direction: column;
            }
            
            .location-btn {
                width: 100%;
                justify-content: center;
            }
            
            .map-controls {
                flex-direction: column;
            }
            
            .map-btn {
                width: 100%;
                justify-content: center;
            }
            
            .realtime-widgets {
                grid-template-columns: 1fr;
            }
            
            .alert-cards-container {
                grid-template-columns: 1fr;
            }
            
            .weather-details {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .weather-temp {
                font-size: 36px;
            }
            
            .weather-icon {
                font-size: 48px;
            }
        }
    </style>
</head>
<body>
    <!-- Floating Navigation -->
    <div class="floating-nav">
        <button class="active" data-tab="home">Home</button>
        <span class="nav-divider">|</span>
        <button data-tab="mapping">Mapping</button>
        <span class="nav-divider">|</span>
        <button data-tab="disaster-alert">Disaster Alert</button>
        <span class="nav-divider">|</span>
        <button data-tab="emergency">Emergency</button>
        <span class="nav-divider">|</span>
        <button data-tab="about">About Us</button>
    </div>

    <main>
        <!-- Home Tab -->
        <div id="home" class="tab-content active">
            <div class="hero-section">
                <div class="hero-content">
                    <h1 class="hero-title">HazardGuard</h1>
                    <p class="hero-subtitle">
                        HazardGuard is a disaster awareness and preparedness website that helps people learn about natural hazards like earthquakes, floods, and landslides in Nepal and provides real‑time alerts and emergency contact information to stay safe.
                    </p>
                    <button class="discover-btn" data-tab="mapping">Discover</button>
                </div>
            </div>

            <div class="container">
                <div class="section-card">
                    <h2 class="section-title">Understanding Disaster Risks in Nepal</h2>
                    
                    <div class="content-text">
                        <p>Natural disasters in Nepal occur unexpectedly and can cause severe damage to communities. The country's diverse geography makes it vulnerable to various hazards that threaten lives and property.</p>
                        <p>Early warning systems and public awareness are crucial for reducing disaster risks. Timely alerts allow communities to prepare, evacuate if necessary, and minimize casualties.</p>
                    </div>
                    
                    <div class="checklist-container">
                        <h3 style="margin-bottom: 20px; font-size: 22px; color: var(--accent-brown);">
                            <i class="fas fa-clipboard-check"></i> Quick Preparedness Checklist
                        </h3>
                        
                        <div class="checklist-item" data-category="essential">
                            <input type="checkbox" id="check1">
                            <label for="check1">Create a family emergency plan with meeting points</label>
                        </div>
                        <div class="checklist-item" data-category="essential">
                            <input type="checkbox" id="check2">
                            <label for="check2">Prepare a 3-day emergency supply kit</label>
                        </div>
                        <div class="checklist-item" data-category="essential">
                            <input type="checkbox" id="check3">
                            <label for="check3">Know your nearest emergency shelter location</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mapping Tab -->
        <div id="mapping" class="tab-content">
            <div class="container">
                <div class="section-card">
                    <h2 class="section-title">Nepal Disaster & Environmental Risk Visualization</h2>
                    
                    <div class="content-text">
                        <p>Visual representation of disaster-prone areas across Nepal. Select different layers to see specific risk types. Click on any location marker to see its weather information.</p>
                    </div>
                    
                    <!-- Weather Widget in Mapping Tab -->
                    <div class="weather-widget-mapping">
                        <div class="weather-header">
                            <div class="weather-location">
                                <i class="fas fa-map-marker-alt"></i>
                                <h4 id="weather-location-name">Kathmandu</h4>
                            </div>
                            <div class="weather-time" id="weather-update-time">Updated: --</div>
                        </div>
                        <div class="weather-main">
                            <div>
                                <div class="weather-temp" id="weather-temp">22°C</div>
                                <div class="weather-condition" id="weather-condition" style="color: var(--text-secondary); font-size: 16px;">Partly Cloudy</div>
                            </div>
                            <div class="weather-icon">
                                <i class="fas fa-cloud-sun" id="weather-icon"></i>
                            </div>
                        </div>
                        <div class="weather-details">
                            <div class="weather-detail">
                                <div class="weather-detail-label">Humidity</div>
                                <div class="weather-detail-value" id="weather-humidity">65%</div>
                            </div>
                            <div class="weather-detail">
                                <div class="weather-detail-label">Wind Speed</div>
                                <div class="weather-detail-value" id="weather-wind">8 km/h</div>
                            </div>
                            <div class="weather-detail">
                                <div class="weather-detail-label">Feels Like</div>
                                <div class="weather-detail-value" id="weather-feels-like">23°C</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="map-wrapper">
                        <div class="map-header">
                            <h3>Interactive Risk Map</h3>
                            <div class="map-controls">
                                <button class="map-btn active" data-layer="all">
                                    <i class="fas fa-layer-group"></i> All Risks
                                </button>
                                <button class="map-btn" data-layer="earthquake">
                                    <i class="fas fa-bolt"></i> Earthquakes
                                </button>
                                <button class="map-btn" data-layer="flood">
                                    <i class="fas fa-water"></i> Flood Risk
                                </button>
                                <button class="map-btn" data-layer="landslide">
                                    <i class="fas fa-layer-group"></i> Landslides
                                </button>
                            </div>
                        </div>
                        
                        <div class="map-container">
                            <div id="district-info" style="position: absolute; top: 24px; left: 24px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); padding: 20px; border-radius: 16px; border: 1px solid var(--border-color); box-shadow: 0 16px 48px rgba(0, 0, 0, 0.1); max-width: 300px; z-index: 500; display: none;">
                                <h4 id="district-name" style="font-size: 16px; margin-bottom: 8px; color: var(--accent-brown);">Select a District</h4>
                                <p id="district-description" style="font-size: 13px; color: var(--text-secondary); margin-bottom: 8px;">Click on any district to see detailed risk information.</p>
                                <div id="district-risks"></div>
                                <p id="district-tips" style="margin-top: 12px; font-style: italic; font-size: 13px; color: var(--text-secondary);"></p>
                            </div>
                            
                            <div class="map-display">
                                <div id="interactive-map"></div>
                            </div>
                            
                            <!-- Legend -->
                            <div class="map-legend" style="position: absolute; bottom: 24px; right: 24px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(12px); padding: 24px; border-radius: 16px; border: 1px solid var(--border-color); box-shadow: 0 16px 48px rgba(0, 0, 0, 0.1); max-width: 280px; z-index: 500;">
                                <h4 style="font-size: 14px; font-weight: 700; margin-bottom: 16px; text-transform: uppercase; letter-spacing: 0.5px;">Risk Level Legend</h4>
                                <div class="legend-item" style="display: flex; align-items: center; margin-bottom: 12px;">
                                    <div class="legend-color" style="background: #ef4444; color: white; font-size: 10px;">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <span style="font-size: 13px; color: var(--text-secondary);">High Risk</span>
                                </div>
                                <div class="legend-item" style="display: flex; align-items: center; margin-bottom: 12px;">
                                    <div class="legend-color" style="background: #f59e0b; color: white; font-size: 10px;">
                                        <i class="fas fa-exclamation-circle"></i>
                                    </div>
                                    <span style="font-size: 13px; color: var(--text-secondary);">Medium Risk</span>
                                </div>
                                <div class="legend-item" style="display: flex; align-items: center; margin-bottom: 12px;">
                                    <div class="legend-color" style="background: #10b981; color: white; font-size: 10px;">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <span style="font-size: 13px; color: var(--text-secondary);">Low Risk</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Disaster Alert Tab -->
        <div id="disaster-alert" class="tab-content">
            <div class="container">
                <div class="section-card">
                    <h2 class="section-title">Real-time Disaster Alert System</h2>
                    
                    <div class="content-text">
                        <p>Get real-time alerts and environmental data for your selected district. Click on any alert card to see specific preparedness actions.</p>
                    </div>
                    
                    <!-- Location Selection -->
                    <div class="location-section" style="margin-bottom: 40px;">
                        <div class="location-prompt" style="display: flex; align-items: center; gap: 16px; background: var(--card-bg); padding: 24px; border-radius: 20px; border: 1px solid var(--border-color); flex-wrap: wrap;">
                            <i class="fas fa-map-marker-alt" style="color: var(--accent-brown); font-size: 24px;"></i>
                            <span id="location-status" style="color: var(--text-secondary); font-size: 16px; flex: 1;">Select your district or use your current location</span>
                            
                            <div class="district-select-wrapper" style="display: flex; align-items: center; gap: 12px; flex: 2; flex-wrap: wrap;">
                                <div class="location-buttons">
                                    <button id="get-my-location-btn" class="location-btn">
                                        <i class="fas fa-location-arrow"></i> Use My Location
                                    </button>
                                    
                                    <button id="show-other-btn" class="location-btn secondary">
                                        Wanna see other?
                                    </button>
                                </div>
                                
                                <select id="district-select" style="flex: 1; padding: 12px 16px; background: var(--secondary-bg); border: 1px solid var(--border-color); border-radius: 10px; color: var(--text-primary); font-size: 14px; min-width: 200px; margin-top: 12px;">
                                    <option value="">-- Select Your District --</option>
                                    <!-- All 77 districts will be populated by JavaScript -->
                                </select>
                                
                                <button id="get-location-btn" style="background: var(--accent-brown); color: white; padding: 12px 24px; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s; font-size: 14px; display: flex; align-items: center; gap: 8px; margin-top: 12px;">
                                    <i class="fas fa-bell"></i> Get Alerts
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Real-time Data Widgets -->
                    <div class="realtime-widgets">
                        <!-- Air Quality Widget -->
                        <div class="realtime-card" id="air-quality-widget">
                            <div class="realtime-header">
                                <h3 class="realtime-title">
                                    <i class="fas fa-wind"></i> Air Quality
                                </h3>
                                <span class="realtime-status status-live" id="air-quality-status">Live</span>
                            </div>
                            <div class="realtime-value">
                                <span id="air-quality-value">--</span>
                                <span class="realtime-unit" id="air-quality-unit">AQI</span>
                            </div>
                            <div class="aqi-indicator">
                                <div class="aqi-marker" id="aqi-marker" style="left: 0%;"></div>
                            </div>
                            <div class="realtime-details">
                                <div class="detail-item">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value" id="air-quality-desc">--</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">PM2.5</span>
                                    <span class="detail-value" id="air-quality-pm25">-- μg/m³</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Location</span>
                                    <span class="detail-value" id="air-quality-location">Select District</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Updated</span>
                                    <span class="detail-value" id="air-quality-time">--</span>
                                </div>
                            </div>
                            <div class="realtime-source">
                                <i class="fas fa-database"></i>
                                Data Source: Department of Environment, Nepal (pollution.gov.np)
                            </div>
                        </div>

                        <!-- Flood Alert Widget -->
                        <div class="realtime-card" id="flood-alert-widget">
                            <div class="realtime-header">
                                <h3 class="realtime-title">
                                    <i class="fas fa-water"></i> Flood Alert
                                </h3>
                                <span class="realtime-status status-live" id="flood-alert-status">Live</span>
                            </div>
                            <div class="realtime-value">
                                <span id="flood-level-value">--</span>
                                <span class="realtime-unit" id="flood-level-unit">m</span>
                            </div>
                            <div class="flood-level-indicator">
                                <div class="flood-marker" id="flood-marker" style="left: 0%;"></div>
                            </div>
                            <div class="realtime-details">
                                <div class="detail-item">
                                    <span class="detail-label">Status</span>
                                    <span class="detail-value" id="flood-alert-desc">--</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">River</span>
                                    <span class="detail-value" id="flood-river">--</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Danger Level</span>
                                    <span class="detail-value" id="flood-danger-level">-- m</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-label">Updated</span>
                                    <span class="detail-value" id="flood-alert-time">--</span>
                                </div>
                            </div>
                            <div class="realtime-source">
                                <i class="fas fa-database"></i>
                                Data Source: Department of Hydrology (hydrology.gov.np)
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin: 20px 0;">
                        <button class="refresh-btn" id="refresh-realtime-data">
                            <i class="fas fa-sync-alt"></i> Refresh Real-time Data
                        </button>
                    </div>
                    
                    <!-- Disaster Alert Cards -->
                    <div class="alert-cards-container" id="alert-cards-container">
                        <!-- Alert cards will be generated by JavaScript based on district -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Emergency Tab -->
        <div id="emergency" class="tab-content">
            <div class="container">
                <div class="section-card">
                    <h2 class="section-title">Emergency Contacts</h2>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 40px; font-size: 16px;">
                        Click any number to call immediately from your device.
                    </p>
                    
                    <div class="emergency-grid">
                        <a href="tel:100" class="emergency-card" data-number="100" style="text-decoration: none; color: inherit;">
                            <div class="emergency-icon-wrapper" style="background: linear-gradient(135deg, rgba(197, 48, 48, 0.15), rgba(197, 48, 48, 0.1)); color: var(--accent-red);">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <h3>Police</h3>
                            <p class="subtitle" style="color: var(--text-secondary); font-size: 14px; margin-bottom: 20px;">Emergency response & law enforcement</p>
                            <div class="emergency-number">
                                <i class="fas fa-phone"></i>
                                <span>100</span>
                            </div>
                            <div class="emergency-description" style="padding-top: 20px; border-top: 1px solid var(--border-color); font-size: 13px; color: var(--text-secondary);">
                                For crimes, accidents, and immediate police assistance.
                            </div>
                        </a>
                        
                        <a href="tel:101" class="emergency-card" data-number="101" style="text-decoration: none; color: inherit;">
                            <div class="emergency-icon-wrapper" style="background: linear-gradient(135deg, rgba(210, 105, 30, 0.15), rgba(210, 105, 30, 0.1)); color: var(--accent-orange);">
                                <i class="fas fa-fire-extinguisher"></i>
                            </div>
                            <h3>Fire Department</h3>
                            <p class="subtitle" style="color: var(--text-secondary); font-size: 14px; margin-bottom: 20px;">Fire emergencies & rescue operations</p>
                            <div class="emergency-number">
                                <i class="fas fa-phone"></i>
                                <span>101</span>
                            </div>
                            <div class="emergency-description" style="padding-top: 20px; border-top: 1px solid var(--border-color); font-size: 13px; color: var(--text-secondary);">
                                For fire incidents, gas leaks, building collapses, and rescues.
                            </div>
                        </a>
                        
                        <a href="tel:102" class="emergency-card" data-number="102" style="text-decoration: none; color: inherit;">
                            <div class="emergency-icon-wrapper" style="background: linear-gradient(135deg, rgba(56, 161, 105, 0.15), rgba(56, 161, 105, 0.1)); color: var(--accent-green);">
                                <i class="fas fa-ambulance"></i>
                            </div>
                            <h3>Ambulance</h3>
                            <p class="subtitle" style="color: var(--text-secondary); font-size: 14px; margin-bottom: 20px;">Medical emergencies & patient transport</p>
                            <div class="emergency-number">
                                <i class="fas fa-phone"></i>
                                <span>102</span>
                            </div>
                            <div class="emergency-description" style="padding-top: 20px; border-top: 1px solid var(--border-color); font-size: 13px; color: var(--text-secondary);">
                                For medical emergencies, accidents, and health crises.
                            </div>
                        </a>
                        
                        <a href="tel:1133" class="emergency-card" data-number="1133" style="text-decoration: none; color: inherit;">
                            <div class="emergency-icon-wrapper" style="background: linear-gradient(135deg, rgba(49, 130, 206, 0.15), rgba(49, 130, 206, 0.1)); color: var(--accent-blue);">
                                <i class="fas fa-life-ring"></i>
                            </div>
                            <h3>Disaster Helpline</h3>
                            <p class="subtitle" style="color: var(--text-secondary); font-size: 14px; margin-bottom: 20px;">Natural disaster emergencies</p>
                            <div class="emergency-number">
                                <i class="fas fa-phone"></i>
                                <span>1133</span>
                            </div>
                            <div class="emergency-description" style="padding-top: 20px; border-top: 1px solid var(--border-color); font-size: 13px; color: var(--text-secondary);">
                                For earthquake, flood, landslide reports and coordination.
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- About Us Tab -->
        <div id="about" class="tab-content">
            <div class="container">
                <div class="section-card">
                    <h2 class="section-title">About Us</h2>
                    
                    <div class="content-text">
                        <p>HazardGuard is developed by a dedicated team of students passionate about disaster awareness and community safety in Nepal.</p>
                    </div>
                    
                    <div class="team-grid">
                        <!-- Samrat Singh Dhami as Lead Developer -->
                        <div class="team-member">
                            <div class="member-avatar">
                                <img src="https://scontent.fktm8-1.fna.fbcdn.net/v/t39.30808-6/491916700_552959374501025_1482130836924941837_n.jpg?_nc_cat=111&ccb=1-7&_nc_sid=a5f93a&_nc_ohc=ZVzMLN_egjcQ7kNvwHxK_Kt&_nc_oc=AdmNJfOAC7XYBQaery64fkO54h38D2WQIFoMrHgaIlf_2NRsGtfhGzAIeVlbej9KImc&_nc_zt=23&_nc_ht=scontent.fktm8-1.fna&_nc_gid=-s07sZ3oN1VNocACmCEbIg&oh=00_Afu4eOAH1ssQ5B7YsE3VoQn7J3303YFtoU7BofGH8_0IzA&oe=699084E0" 
                                     alt="Samrat Singh Dhami"
                                     onerror="this.style.display='none'; this.parentElement.innerHTML='SD'; this.parentElement.style.background='linear-gradient(135deg, var(--accent-brown), var(--accent-orange))';">
                            </div>
                            <h3 class="member-name" style="font-size: 20px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">Samrat Singh Dhami</h3>
                            <div class="member-role" style="color: var(--accent-brown); font-weight: 500; margin-bottom: 16px;">Lead Developer</div>
                            <p class="member-description" style="color: var(--text-secondary); font-size: 15px; line-height: 1.6;">Lead programmer and architect behind HazardGuard's functionality and data systems.</p>
                        </div>
                        
                        <!-- Aayushman Malla as Presenter -->
                        <div class="team-member">
                            <div class="member-avatar">
                                <img src="https://scontent.fktm8-1.fna.fbcdn.net/v/t39.30808-6/557521216_31614599608184331_6757841387331493315_n.jpg?_nc_cat=100&ccb=1-7&_nc_sid=833d8c&_nc_ohc=TDmE_DdcjH0Q7kNvwG2rOMR&_nc_oc=AdmSM08Te81TzZDdi6DlAg6loQw3s18f0huukOmjERUwFHP13QRA4Ub-lx7wINDgLTw&_nc_zt=23&_nc_ht=scontent.fktm8-1.fna&_nc_gid=7i8WKD-H5-JE9jIYQNjNaQ&oh=00_Aft-mm1E9Q_1f1VnkKOD_nIcajURTQvNr75sQPRsSBPq4w&oe=6990ABE2" 
                                     alt="Aayushman Malla"
                                     onerror="this.style.display='none'; this.parentElement.innerHTML='AM'; this.parentElement.style.background='linear-gradient(135deg, var(--accent-brown), var(--accent-orange))';">
                            </div>
                            <h3 class="member-name" style="font-size: 20px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">Aayushman Malla</h3>
                            <div class="member-role" style="color: var(--accent-brown); font-weight: 500; margin-bottom: 16px;">Presenter</div>
                            <p class="member-description" style="color: var(--text-secondary); font-size: 15px; line-height: 1.6;">Presented the project and communicated the vision and functionality to stakeholders.</p>
                        </div>
                        
                        <!-- Digant Gautam as UI/UX Designer -->
                        <div class="team-member">
                            <div class="member-avatar">
                                <img src="https://scontent.fktm20-1.fna.fbcdn.net/v/t39.30808-6/504338220_10238900539512563_4574113430057900343_n.jpg?stp=cp6_dst-jpg_tt6&_nc_cat=100&ccb=1-7&_nc_sid=833d8c&_nc_ohc=R2e4sYijmicQ7kNvwFEDZK8&_nc_oc=AdlfAF8xhNzsainHQkffvXm-92tWAD18T2ByUh22NBf_82TOlMbOpGBDS9tfEe42qhRB2yXWxfpHRojQRZmsuNAE&_nc_zt=23&_nc_ht=scontent.fktm20-1.fna&_nc_gid=XWlgbEV_6TIiBxWeQwo2IA&oh=00_Afs4yghDOxO4r7LX7nd9WAT974SJZu-YSbaiKVj5yAtUVA&oe=6990FFD4" 
                                     alt="Digant Gautam"
                                     onerror="this.style.display='none'; this.parentElement.innerHTML='DG'; this.parentElement.style.background='linear-gradient(135deg, var(--accent-brown), var(--accent-orange))';">
                            </div>
                            <h3 class="member-name" style="font-size: 20px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">Digant Gautam</h3>
                            <div class="member-role" style="color: var(--accent-brown); font-weight: 500; margin-bottom: 16px;">UI/UX Designer</div>
                            <p class="member-description" style="color: var(--text-secondary); font-size: 15px; line-height: 1.6;">Designed the user interface and experience to ensure intuitive navigation and accessibility.</p>
                        </div>
                        
                        <!-- Siddartha Dahal with new photo -->
                        <div class="team-member">
                            <div class="member-avatar">
                                <img src="https://chatgpt.com/backend-api/estuary/content?id=file_000000000f7c71fa88a183749d9a1872&ts=491870&p=fs&cid=1&sig=067bc3c1f2ebc2ab2563f92410dd1a90696a5fb51603a73fe57cad7ff9d83b27&v=0" 
                                     alt="Siddartha Dahal"
                                     onerror="this.style.display='none'; this.parentElement.innerHTML='SD'; this.parentElement.style.background='linear-gradient(135deg, var(--accent-brown), var(--accent-orange))';">
                            </div>
                            <h3 class="member-name" style="font-size: 20px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">Siddartha Dahal</h3>
                            <div class="member-role" style="color: var(--accent-brown); font-weight: 500; margin-bottom: 16px;">Sub Helper</div>
                            <p class="member-description" style="color: var(--text-secondary); font-size: 15px; line-height: 1.6;">Provided research support and assisted with implementation of key features.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Alert Details Modal -->
    <div class="alert-modal" id="alert-modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-exclamation-triangle" id="modal-icon"></i>
                    <span id="modal-title">Alert Details</span>
                </div>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modal-risk-level" style="margin-bottom: 20px; padding: 8px 16px; border-radius: 20px; display: inline-block; font-size: 14px; font-weight: 600;"></div>
                <h3 style="margin-bottom: 15px; color: var(--text-primary);" id="modal-alert-title"></h3>
                <p style="color: var(--text-secondary); margin-bottom: 25px;" id="modal-description"></p>
                
                <h4 style="margin-bottom: 15px; color: var(--accent-brown);"><i class="fas fa-clipboard-list"></i> Preparedness Actions</h4>
                <ul class="preparedness-list" id="preparedness-list">
                    <!-- Preparedness items will be added by JavaScript -->
                </ul>
                
                <div style="margin-top: 25px; padding: 15px; background: rgba(212, 201, 186, 0.1); border-radius: 12px;">
                    <p style="color: var(--text-secondary); font-size: 14px; margin-bottom: 10px;"><i class="fas fa-info-circle"></i> <strong>Note:</strong></p>
                    <p style="color: var(--text-secondary); font-size: 14px;" id="modal-note"></p>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <h3>HazardGuard Nepal</h3>
                <p>A disaster awareness and preparedness platform designed to enhance community safety through education, real-time information, and emergency resources.</p>
                <p style="margin-top: 20px; font-size: 14px; color: var(--text-secondary);">
                    © 2024 HazardGuard | Educational Project | Real-time data from Department of Environment & Department of Hydrology, Nepal
                </p>
            </div>
        </div>
    </footer>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <!-- Leaflet Control Geocoder for search -->
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab switching functionality
            const tabButtons = document.querySelectorAll('.floating-nav button, .discover-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            function switchTab(tabId) {
                // Update floating nav buttons
                document.querySelectorAll('.floating-nav button').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-tab') === tabId) {
                        btn.classList.add('active');
                    }
                });
                
                // Update tab contents
                tabContents.forEach(content => {
                    content.classList.remove('active');
                    if (content.id === tabId) {
                        content.classList.add('active');
                    }
                });
                
                // Initialize map when mapping tab is opened
                if (tabId === 'mapping' && window.map === undefined) {
                    setTimeout(initializeMap, 100);
                }
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
            
            // Add click handlers to floating nav buttons
            document.querySelectorAll('.floating-nav button').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    switchTab(this.getAttribute('data-tab'));
                });
            });
            
            // Discover button handler
            document.querySelector('.discover-btn').addEventListener('click', function(e) {
                e.preventDefault();
                switchTab(this.getAttribute('data-tab'));
            });
            
            // Refresh button
            const refreshBtn = document.getElementById('refresh-realtime-data');
            refreshBtn.addEventListener('click', function() {
                refreshBtn.classList.add('updating');
                refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Updating...';
                
                // Update all real-time data
                updateAirQualityData();
                updateFloodAlertData();
                updateWeatherData();
                
                setTimeout(() => {
                    refreshBtn.classList.remove('updating');
                    refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i> Refresh Real-time Data';
                }, 1500);
            });
            
            // Modal functionality
            const alertModal = document.getElementById('alert-modal');
            const modalClose = document.getElementById('modal-close');
            
            modalClose.addEventListener('click', function() {
                alertModal.style.display = 'none';
            });
            
            alertModal.addEventListener('click', function(e) {
                if (e.target === alertModal) {
                    alertModal.style.display = 'none';
                }
            });
            
            // Practical preparedness data with realistic tips
            const preparednessData = {
                'earthquake': {
                    high: {
                        title: 'Earthquake Alert - High Risk',
                        icon: 'fas fa-bolt',
                        alertTitle: 'Immediate Action Required',
                        description: 'Your area is in a high-risk earthquake zone. Major seismic activity is possible.',
                        riskLevel: 'HIGH RISK',
                        riskColor: '#ef4444',
                        preparedness: [
                            'Store emergency water (4 liters per person per day for 3 days)',
                            'Secure heavy furniture like cabinets, shelves, and water heaters to walls',
                            'Prepare "go-bag" with first aid, flashlight, batteries, whistle, and documents',
                            'Identify safe spots in every room (under sturdy tables, against interior walls)',
                            'Practice "Drop, Cover, and Hold On" drill with family monthly',
                            'Know how to shut off gas, water, and electricity mains'
                        ],
                        note: 'During shaking: Drop to hands and knees, Cover head under table, Hold on until shaking stops.'
                    },
                    medium: {
                        title: 'Earthquake Alert - Medium Risk',
                        icon: 'fas fa-bolt',
                        alertTitle: 'Stay Prepared and Vigilant',
                        description: 'Your area has moderate earthquake risk. Stay informed and prepared.',
                        riskLevel: 'MEDIUM RISK',
                        riskColor: '#f59e0b',
                        preparedness: [
                            'Prepare 3-day emergency kit with water, food, medicine, and cash',
                            'Secure tall furniture that could topple during shaking',
                            'Have fire extinguishers and know how to use them',
                            'Create family emergency plan with meeting points',
                            'Keep shoes and flashlight beside bed for night emergencies',
                            'Participate in community earthquake drills'
                        ],
                        note: 'Check your home for hazards: loose shelves, hanging objects, poor building materials.'
                    },
                    low: {
                        title: 'Earthquake Alert - Low Risk',
                        icon: 'fas fa-bolt',
                        alertTitle: 'Maintain Basic Preparedness',
                        description: 'Your area has low earthquake risk. Maintain basic preparedness.',
                        riskLevel: 'LOW RISK',
                        riskColor: '#10b981',
                        preparedness: [
                            'Keep basic emergency supplies: water, non-perishable food, first aid',
                            'Learn basic first aid and CPR techniques',
                            'Keep emergency contact numbers in phone and wallet',
                            'Review earthquake safety procedures every 6 months',
                            'Ensure your home insurance covers earthquake damage',
                            'Stay informed about seismic activity through official channels'
                        ],
                        note: 'While risk is low, earthquakes can occur anywhere without warning.'
                    }
                },
                'flood': {
                    high: {
                        title: 'Flood Alert - High Risk',
                        icon: 'fas fa-water',
                        alertTitle: 'Immediate Evacuation May Be Required',
                        description: 'Your area is at high risk of flooding. River levels are above danger threshold.',
                        riskLevel: 'HIGH RISK',
                        riskColor: '#ef4444',
                        preparedness: [
                            'Move to higher ground immediately if advised by authorities',
                            'Prepare emergency bag with medicines, documents, phone charger, cash',
                            'Turn off electricity, gas, and water mains before evacuating',
                            'Move valuables and electronics to upper floors',
                            'Fill bathtubs and containers with clean drinking water',
                            'Never walk or drive through flood waters (15cm can sweep you away)'
                        ],
                        note: 'Stay tuned to local radio for evacuation orders. Do not return until authorities say it\'s safe.'
                    },
                    medium: {
                        title: 'Flood Alert - Medium Risk',
                        icon: 'fas fa-water',
                        alertTitle: 'Prepare for Possible Flooding',
                        description: 'Your area has moderate flood risk. Monitor weather conditions closely.',
                        riskLevel: 'MEDIUM RISK',
                        riskColor: '#f59e0b',
                        preparedness: [
                            'Prepare sandbags for doorways and low openings',
                            'Clear gutters, drains, and drainage channels',
                            'Move important items to higher shelves or upper floors',
                            'Prepare emergency supplies for 3-5 days',
                            'Identify safe evacuation routes to higher ground',
                            'Charge phones and power banks, keep radio batteries ready'
                        ],
                        note: 'Monitor river levels during monsoon. Be ready to evacuate if water rises rapidly.'
                    },
                    low: {
                        title: 'Flood Alert - Low Risk',
                        icon: 'fas fa-water',
                        alertTitle: 'Monitor Conditions During Monsoon',
                        description: 'Your area has low flood risk. Stay informed about weather changes.',
                        riskLevel: 'LOW RISK',
                        riskColor: '#10b981',
                        preparedness: [
                            'Keep drainage systems clear of debris',
                            'Have emergency contact numbers saved in phone',
                            'Monitor river levels and weather forecasts during monsoon',
                            'Prepare basic emergency kit with flashlight, radio, first aid',
                            'Know location of nearest evacuation shelters',
                            'Check weather forecasts 2-3 times daily during rainy season'
                        ],
                        note: 'Low risk areas can still experience flash floods during heavy rainfall.'
                    }
                },
                'landslide': {
                    high: {
                        title: 'Landslide Alert - High Risk',
                        icon: 'fas fa-layer-group',
                        alertTitle: 'Extreme Danger - Avoid Hillsides',
                        description: 'Your area is at extreme risk of landslides due to terrain and rainfall.',
                        riskLevel: 'HIGH RISK',
                        riskColor: '#ef4444',
                        preparedness: [
                            'Evacuate immediately if in landslide-prone area during heavy rain',
                            'Avoid all hillside roads, paths, and unstable slopes',
                            'Listen for unusual sounds (trees cracking, boulders knocking)',
                            'Watch for signs: new cracks in ground, tilting trees, bulging ground',
                            'Move to stable ground away from base of slopes',
                            'Do not return until authorities declare area safe'
                        ],
                        note: 'Landslides can occur suddenly with little warning. Move diagonally across slope if caught in one.'
                    },
                    medium: {
                        title: 'Landslide Alert - Medium Risk',
                        icon: 'fas fa-layer-group',
                        alertTitle: 'Exercise Caution on Slopes',
                        description: 'Your area has moderate landslide risk. Avoid unstable slopes.',
                        riskLevel: 'MEDIUM RISK',
                        riskColor: '#f59e0b',
                        preparedness: [
                            'Avoid hillside areas during and after heavy rainfall',
                            'Watch for signs of soil movement or small slides',
                            'Stay informed about rainfall forecasts and warnings',
                            'Identify safe evacuation routes away from slopes',
                            'Keep emergency supplies ready for quick evacuation',
                            'Report any slope cracks or erosion to local authorities'
                        ],
                        note: 'Be particularly cautious after prolonged rainfall when soil is saturated.'
                    },
                    low: {
                        title: 'Landslide Alert - Low Risk',
                        icon: 'fas fa-layer-group',
                        alertTitle: 'Stay Vigilant in Hilly Areas',
                        description: 'Your area has low landslide risk. Basic precautions recommended.',
                        riskLevel: 'LOW RISK',
                        riskColor: '#10b981',
                        preparedness: [
                            'Avoid steep slopes and cuttings during heavy rain',
                            'Monitor weather conditions during monsoon season',
                            'Know signs of potential landslides: tilted poles, cracks',
                            'Have emergency contact numbers for local disaster management',
                            'Stay on established trails in hilly areas',
                            'Report any slope instability or erosion to authorities'
                        ],
                        note: 'Even low-risk areas can experience landslides during extreme weather.'
                    }
                }
            };
            
            // Function to show alert details modal
            function showAlertDetails(alertData) {
                document.getElementById('modal-title').textContent = alertData.title;
                document.getElementById('modal-icon').className = alertData.icon;
                document.getElementById('modal-alert-title').textContent = alertData.alertTitle;
                document.getElementById('modal-description').textContent = alertData.description;
                document.getElementById('modal-note').textContent = alertData.note;
                
                // Set risk level badge
                const riskLevelElement = document.getElementById('modal-risk-level');
                riskLevelElement.textContent = alertData.riskLevel;
                riskLevelElement.style.background = alertData.riskColor;
                riskLevelElement.style.color = 'white';
                
                // Clear and add preparedness items
                const preparednessList = document.getElementById('preparedness-list');
                preparednessList.innerHTML = '';
                
                alertData.preparedness.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `<i class="fas fa-check-circle"></i> ${item}`;
                    preparednessList.appendChild(li);
                });
                
                alertModal.style.display = 'flex';
            }
            
            // Current district tracking
            let currentDistrict = 'Kathmandu';
            
            // District risk database
            const districtRiskData = {
                'kathmandu': { earthquake: 'high', flood: 'low', landslide: 'medium' },
                'pokhara': { earthquake: 'medium', flood: 'low', landslide: 'high' },
                'biratnagar': { earthquake: 'low', flood: 'high', landslide: 'low' },
                'nepalgunj': { earthquake: 'low', flood: 'high', landslide: 'low' },
                'jhapa': { earthquake: 'medium', flood: 'high', landslide: 'low' },
                'kaski': { earthquake: 'medium', flood: 'low', landslide: 'high' },
                'saptari': { earthquake: 'low', flood: 'high', landslide: 'low' },
                'sindhupalchok': { earthquake: 'high', flood: 'medium', landslide: 'high' },
                'gorkha': { earthquake: 'high', flood: 'medium', landslide: 'high' },
                'chitwan': { earthquake: 'medium', flood: 'medium', landslide: 'medium' },
                'default': { earthquake: 'medium', flood: 'medium', landslide: 'medium' }
            };
            
            // District air quality data
            const airQualityData = {
                'kathmandu': { aqi: 85, pm25: 42, level: 'Moderate' },
                'pokhara': { aqi: 45, pm25: 22, level: 'Good' },
                'biratnagar': { aqi: 132, pm25: 68, level: 'Unhealthy' },
                'nepalgunj': { aqi: 98, pm25: 48, level: 'Moderate' },
                'jhapa': { aqi: 65, pm25: 35, level: 'Moderate' },
                'kaski': { aqi: 40, pm25: 20, level: 'Good' },
                'saptari': { aqi: 110, pm25: 55, level: 'Unhealthy' },
                'sindhupalchok': { aqi: 70, pm25: 38, level: 'Moderate' },
                'default': { aqi: 75, pm25: 35, level: 'Moderate' }
            };
            
            // District flood data
            const floodData = {
                'kathmandu': { level: 3.2, danger: 4.5, status: 'Normal', river: 'Bagmati' },
                'pokhara': { level: 1.8, danger: 3.0, status: 'Normal', river: 'Seti' },
                'biratnagar': { level: 5.8, danger: 6.5, status: 'Warning', river: 'Koshi' },
                'nepalgunj': { level: 4.2, danger: 5.0, status: 'Normal', river: 'Karnali' },
                'jhapa': { level: 6.1, danger: 7.0, status: 'Warning', river: 'Mechi' },
                'kaski': { level: 2.5, danger: 4.0, status: 'Normal', river: 'Seti' },
                'saptari': { level: 7.2, danger: 8.0, status: 'Alert', river: 'Koshi' },
                'sindhupalchok': { level: 3.8, danger: 6.0, status: 'Normal', river: 'Indrawati' },
                'default': { level: 3.0, danger: 5.0, status: 'Normal', river: 'Local River' }
            };
            
            // District weather data
            const weatherData = {
                'kathmandu': { temp: 22, condition: 'Partly Cloudy', humidity: 65, wind: 8, feelsLike: 23, icon: 'fa-cloud-sun' },
                'pokhara': { temp: 20, condition: 'Light Rain', humidity: 75, wind: 5, feelsLike: 21, icon: 'fa-cloud-rain' },
                'biratnagar': { temp: 32, condition: 'Hot and Humid', humidity: 70, wind: 12, feelsLike: 35, icon: 'fa-sun' },
                'nepalgunj': { temp: 30, condition: 'Clear', humidity: 60, wind: 10, feelsLike: 32, icon: 'fa-sun' },
                'jhapa': { temp: 28, condition: 'Partly Cloudy', humidity: 68, wind: 6, feelsLike: 30, icon: 'fa-cloud-sun' },
                'kaski': { temp: 20, condition: 'Light Rain', humidity: 80, wind: 4, feelsLike: 21, icon: 'fa-cloud-rain' },
                'saptari': { temp: 32, condition: 'Hot', humidity: 65, wind: 15, feelsLike: 36, icon: 'fa-sun' },
                'sindhupalchok': { temp: 18, condition: 'Cool', humidity: 70, wind: 7, feelsLike: 19, icon: 'fa-cloud' },
                'gorkha': { temp: 21, condition: 'Partly Cloudy', humidity: 72, wind: 6, feelsLike: 22, icon: 'fa-cloud-sun' },
                'chitwan': { temp: 26, condition: 'Clear', humidity: 65, wind: 8, feelsLike: 28, icon: 'fa-sun' },
                'default': { temp: 25, condition: 'Partly Cloudy', humidity: 65, wind: 8, feelsLike: 26, icon: 'fa-cloud-sun' }
            };
            
            // Real-time data functions
            function updateAirQualityData() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                let districtKey = currentDistrict.toLowerCase();
                const data = airQualityData[districtKey] || airQualityData['default'];
                
                document.getElementById('air-quality-value').textContent = data.aqi;
                document.getElementById('air-quality-desc').textContent = data.level;
                document.getElementById('air-quality-pm25').textContent = `${data.pm25} μg/m³`;
                document.getElementById('air-quality-location').textContent = currentDistrict;
                document.getElementById('air-quality-time').textContent = timeString;
                
                const aqiPosition = Math.min((data.aqi / 500) * 100, 100);
                document.getElementById('aqi-marker').style.left = `${aqiPosition}%`;
                
                let statusColor = '';
                if (data.aqi <= 50) statusColor = 'var(--aqi-good)';
                else if (data.aqi <= 100) statusColor = 'var(--aqi-moderate)';
                else if (data.aqi <= 150) statusColor = 'var(--aqi-sensitive)';
                else if (data.aqi <= 200) statusColor = 'var(--aqi-unhealthy)';
                else if (data.aqi <= 300) statusColor = 'var(--aqi-very-unhealthy)';
                else statusColor = 'var(--aqi-hazardous)';
                
                document.getElementById('aqi-marker').style.borderColor = statusColor;
            }
            
            function updateFloodAlertData() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                let districtKey = currentDistrict.toLowerCase();
                const data = floodData[districtKey] || floodData['default'];
                
                const percentage = (data.level / data.danger) * 100;
                
                document.getElementById('flood-level-value').textContent = data.level.toFixed(1);
                document.getElementById('flood-alert-desc').textContent = data.status;
                document.getElementById('flood-river').textContent = data.river;
                document.getElementById('flood-danger-level').textContent = `${data.danger} m`;
                document.getElementById('flood-alert-time').textContent = timeString;
                
                const markerPosition = Math.min(percentage, 100);
                document.getElementById('flood-marker').style.left = `${markerPosition}%`;
                
                let statusColor = '';
                if (percentage < 50) statusColor = 'var(--accent-green)';
                else if (percentage < 75) statusColor = 'var(--accent-blue)';
                else if (percentage < 100) statusColor = 'var(--accent-orange)';
                else statusColor = 'var(--accent-red)';
                
                document.getElementById('flood-marker').style.borderColor = statusColor;
            }
            
            function updateWeatherData() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                let districtKey = currentDistrict.toLowerCase();
                const data = weatherData[districtKey] || weatherData['default'];
                
                document.getElementById('weather-location-name').textContent = currentDistrict;
                document.getElementById('weather-update-time').textContent = `Updated: ${timeString}`;
                document.getElementById('weather-temp').textContent = `${data.temp}°C`;
                document.getElementById('weather-condition').textContent = data.condition;
                document.getElementById('weather-humidity').textContent = `${data.humidity}%`;
                document.getElementById('weather-wind').textContent = `${data.wind} km/h`;
                document.getElementById('weather-feels-like').textContent = `${data.feelsLike}°C`;
                document.getElementById('weather-icon').className = `fas ${data.icon}`;
            }
            
            // Update weather for specific location (for map clicks)
            function updateWeatherForLocation(locationName) {
                const now = new Date();
                const timeString = now.toLocaleTimeString('en-US', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                
                let districtKey = locationName.toLowerCase();
                const data = weatherData[districtKey] || weatherData['default'];
                
                document.getElementById('weather-location-name').textContent = locationName;
                document.getElementById('weather-update-time').textContent = `Updated: ${timeString}`;
                document.getElementById('weather-temp').textContent = `${data.temp}°C`;
                document.getElementById('weather-condition').textContent = data.condition;
                document.getElementById('weather-humidity').textContent = `${data.humidity}%`;
                document.getElementById('weather-wind').textContent = `${data.wind} km/h`;
                document.getElementById('weather-feels-like').textContent = `${data.feelsLike}°C`;
                document.getElementById('weather-icon').className = `fas ${data.icon}`;
            }
            
            // Generate alert cards based on current district
            function generateAlertCards() {
                const container = document.getElementById('alert-cards-container');
                container.innerHTML = '';
                
                const alertTypes = ['earthquake', 'flood', 'landslide'];
                const districtKey = currentDistrict.toLowerCase();
                const risks = districtRiskData[districtKey] || districtRiskData['default'];
                
                alertTypes.forEach(type => {
                    const riskLevel = risks[type] || 'medium';
                    const riskClass = `${riskLevel}-risk`;
                    const alertData = preparednessData[type][riskLevel];
                    const icons = {
                        'earthquake': 'fas fa-bolt',
                        'flood': 'fas fa-water',
                        'landslide': 'fas fa-layer-group'
                    };
                    
                    const card = document.createElement('div');
                    card.className = `alert-card ${riskClass}`;
                    card.dataset.type = type;
                    card.dataset.risk = riskLevel;
                    
                    card.innerHTML = `
                        <div class="alert-header">
                            <div class="alert-icon">
                                <i class="${icons[type]}"></i>
                            </div>
                            <span class="alert-badge">${riskLevel.toUpperCase()} RISK</span>
                        </div>
                        <h3 class="alert-title">${type.charAt(0).toUpperCase() + type.slice(1)} Alert</h3>
                        <p class="alert-description">${alertData.alertTitle}</p>
                        <div class="alert-actions">
                            <span class="alert-click-hint">
                                <i class="fas fa-hand-pointer"></i>
                                Click for preparedness details
                            </span>
                            <span style="font-size: 12px; color: var(--text-secondary);">
                                <i class="far fa-clock"></i> Updated: ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                            </span>
                        </div>
                    `;
                    
                    card.addEventListener('click', function() {
                        showAlertDetails(alertData);
                    });
                    
                    container.appendChild(card);
                });
            }
            
            // District selection
            const districtSelect = document.getElementById('district-select');
            const getLocationBtn = document.getElementById('get-location-btn');
            const locationStatus = document.getElementById('location-status');
            const getMyLocationBtn = document.getElementById('get-my-location-btn');
            const showOtherBtn = document.getElementById('show-other-btn');
            
            // All 77 districts of Nepal
            const allDistricts = {
                "Province 1": ["Bhojpur", "Dhankuta", "Ilam", "Jhapa", "Khotang", "Morang", "Okhaldhunga", "Panchthar", "Sankhuwasabha", "Solukhumbu", "Sunsari", "Taplejung", "Terhathum", "Udayapur"],
                "Province 2": ["Saptari", "Siraha", "Dhanusha", "Mahottari", "Sarlahi", "Rautahat", "Bara", "Parsa"],
                "Bagmati": ["Dolakha", "Ramechhap", "Sindhuli", "Kathmandu", "Bhaktapur", "Lalitpur", "Kavrepalanchok", "Nuwakot", "Rasuwa", "Dhading", "Makwanpur", "Chitwan"],
                "Gandaki": ["Gorkha", "Lamjung", "Tanahun", "Syangja", "Kaski", "Manang", "Mustang", "Myagdi", "Parbat", "Baglung", "Nawalpur"],
                "Lumbini": ["Rupandehi", "Kapilvastu", "Arghakhanchi", "Gulmi", "Palpa", "Nawalparasi West", "Nawalparasi East", "Dang", "Pyuthan", "Rolpa", "Eastern Rukum", "Banke", "Bardiya"],
                "Karnali": ["Western Rukum", "Salyan", "Dolpa", "Mugu", "Humla", "Jumla", "Kalikot", "Dailekh", "Jajarkot", "Surkhet"],
                "Sudurpashchim": ["Kailali", "Kanchanpur", "Dadeldhura", "Baitadi", "Darchula", "Bajhang", "Bajura", "Doti", "Achham"]
            };
            
            // Populate district select
            function populateAllDistricts() {
                districtSelect.innerHTML = '<option value="">-- Select Your District --</option>';
                
                for (const province in allDistricts) {
                    const optgroup = document.createElement('optgroup');
                    optgroup.label = province;
                    
                    allDistricts[province].forEach(district => {
                        const option = document.createElement('option');
                        option.value = district;
                        option.textContent = district;
                        if (district === 'Kathmandu') option.selected = true;
                        optgroup.appendChild(option);
                    });
                    
                    districtSelect.appendChild(optgroup);
                }
            }
            
            // Initialize with all districts
            populateAllDistricts();
            
            // Update alerts function
            function updateAlerts(districtName) {
                currentDistrict = districtName;
                
                // Update location status
                locationStatus.innerHTML = `<i class="fas fa-map-marker-alt" style="color: var(--accent-green);"></i> Alerts for: ${districtName} District`;
                
                // Update all data
                updateAirQualityData();
                updateFloodAlertData();
                updateWeatherData();
                generateAlertCards();
                
                // Show success message
                const originalText = getLocationBtn.innerHTML;
                getLocationBtn.innerHTML = '<i class="fas fa-check"></i> Alerts Updated!';
                getLocationBtn.style.background = 'var(--accent-green)';
                
                setTimeout(() => {
                    getLocationBtn.innerHTML = '<i class="fas fa-bell"></i> Get Alerts';
                    getLocationBtn.style.background = '';
                }, 2000);
            }
            
            // Get alerts button handler
            getLocationBtn.addEventListener('click', function() {
                const selectedDistrict = districtSelect.value;
                
                if (!selectedDistrict) {
                    locationStatus.innerHTML = '<i class="fas fa-exclamation-triangle" style="color: var(--accent-orange);"></i> Please select a district first';
                    return;
                }
                
                updateAlerts(selectedDistrict);
            });
            
            // Get user's location
            getMyLocationBtn.addEventListener('click', function() {
                const originalText = getMyLocationBtn.innerHTML;
                getMyLocationBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Detecting...';
                
                setTimeout(() => {
                    // Simulate location detection
                    districtSelect.value = 'Kathmandu';
                    updateAlerts('Kathmandu');
                    
                    getMyLocationBtn.innerHTML = originalText;
                    
                    // Show message
                    const modal = document.createElement('div');
                    modal.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1000; display: flex; justify-content: center; align-items: center;';
                    modal.innerHTML = `
                        <div style="background: var(--card-bg); border-radius: 20px; padding: 30px; max-width: 400px; width: 90%; border: 1px solid var(--border-color); text-align: center;">
                            <h3 style="color: var(--accent-brown); margin-bottom: 15px;"><i class="fas fa-check-circle" style="color: var(--accent-green);"></i> Location Detected</h3>
                            <p style="color: var(--text-secondary); margin-bottom: 20px;">Your location has been detected as <strong>Kathmandu</strong>. Alerts have been updated.</p>
                            <button id="close-modal" style="background: var(--accent-brown); color: white; border: none; border-radius: 10px; padding: 12px 24px; font-weight: 600; cursor: pointer;">
                                OK
                            </button>
                        </div>
                    `;
                    
                    document.body.appendChild(modal);
                    
                    modal.querySelector('#close-modal').addEventListener('click', () => {
                        document.body.removeChild(modal);
                    });
                    
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) {
                            document.body.removeChild(modal);
                        }
                    });
                }, 1500);
            });
            
            // Initialize with default data
            updateAirQualityData();
            updateFloodAlertData();
            updateWeatherData();
            generateAlertCards();
            
            // Map initialization
            let map;
            let riskLayers = {};
            
            function initializeMap() {
                // Initialize map centered on Nepal
                map = L.map('interactive-map').setView([28.3949, 84.1240], 7);
                
                // Add tile layer
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors',
                    maxZoom: 10,
                    minZoom: 6
                }).addTo(map);
                
                // Add search control
                L.Control.geocoder({
                    defaultMarkGeocode: false
                }).on('markgeocode', function(e) {
                    var bbox = e.geocode.bbox;
                    map.fitBounds(bbox);
                }).addTo(map);
                
                // Define risk zones with click functionality
                const riskZones = [
                    { name: 'Kathmandu', latlng: [27.7172, 85.3240], risks: ['earthquake'], level: 'high' },
                    { name: 'Pokhara', latlng: [28.2096, 83.9856], risks: ['landslide'], level: 'high' },
                    { name: 'Sindhupalchok', latlng: [27.9167, 85.5833], risks: ['earthquake', 'landslide'], level: 'high' },
                    { name: 'Saptari', latlng: [26.5833, 86.8333], risks: ['flood'], level: 'high' },
                    { name: 'Gorkha', latlng: [28.3333, 84.9167], risks: ['earthquake'], level: 'high' },
                    { name: 'Biratnagar', latlng: [26.4833, 87.2833], risks: ['flood'], level: 'high' },
                    { name: 'Nepalgunj', latlng: [28.0500, 81.6167], risks: ['flood'], level: 'medium' },
                    { name: 'Kaski', latlng: [28.2096, 83.9856], risks: ['landslide'], level: 'high' },
                    { name: 'Jhapa', latlng: [26.5833, 87.9167], risks: ['flood'], level: 'high' },
                    { name: 'Chitwan', latlng: [27.5833, 84.5000], risks: ['flood', 'earthquake'], level: 'medium' }
                ];
                
                // Create layer groups
                riskLayers.earthquake = L.layerGroup();
                riskLayers.flood = L.layerGroup();
                riskLayers.landslide = L.layerGroup();
                riskLayers.all = L.layerGroup();
                
                // Add markers for each risk zone
                riskZones.forEach(zone => {
                    let color;
                    switch(zone.level) {
                        case 'high': color = '#ef4444'; break;
                        case 'medium': color = '#f59e0b'; break;
                        case 'low': color = '#10b981'; break;
                        default: color = '#6b7280';
                    }
                    
                    // Create custom icon
                    const icon = L.divIcon({
                        className: 'custom-marker',
                        html: `<div style="
                            background: ${color};
                            width: 24px;
                            height: 24px;
                            border-radius: 50%;
                            border: 3px solid white;
                            box-shadow: 0 0 10px rgba(0,0,0,0.3);
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            color: white;
                            font-size: 12px;
                            cursor: pointer;
                        ">
                            ${zone.risks.includes('earthquake') ? '⛰️' : 
                              zone.risks.includes('flood') ? '🌊' : '⛰️'}
                        </div>`,
                        iconSize: [30, 30],
                        iconAnchor: [15, 15]
                    });
                    
                    const marker = L.marker(zone.latlng, { icon: icon })
                        .bindPopup(`
                            <div style="min-width: 200px;">
                                <h4 style="margin: 0 0 8px 0; color: var(--accent-brown);">${zone.name}</h4>
                                <p style="margin: 4px 0; font-size: 12px;">
                                    <strong>Risk Level:</strong> 
                                    <span style="color: ${color}; font-weight: bold;">${zone.level.toUpperCase()}</span>
                                </p>
                                <p style="margin: 4px 0; font-size: 12px;">
                                    <strong>Primary Risks:</strong> ${zone.risks.join(', ')}
                                </p>
                                <button onclick="updateWeatherFromMap('${zone.name}')" 
                                        style="width: 100%; margin-top: 8px; padding: 6px; background: var(--accent-brown); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">
                                    <i class="fas fa-cloud-sun"></i> View Weather
                                </button>
                            </div>
                        `);
                    
                    // Add click handler to update district info
                    marker.on('click', function() {
                        const districtInfo = document.getElementById('district-info');
                        const districtName = document.getElementById('district-name');
                        const districtDescription = document.getElementById('district-description');
                        const districtRisks = document.getElementById('district-risks');
                        const districtTips = document.getElementById('district-tips');
                        
                        districtName.textContent = zone.name;
                        districtDescription.textContent = `Located in Nepal with ${zone.level} risk level`;
                        
                        // Update weather widget
                        updateWeatherForLocation(zone.name);
                        
                        // Clear and add risk tags
                        districtRisks.innerHTML = '';
                        zone.risks.forEach(risk => {
                            const tag = document.createElement('span');
                            tag.className = `risk-tag ${risk}`;
                            tag.style.cssText = 'display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-right: 6px; margin-bottom: 6px;';
                            if (risk === 'earthquake') {
                                tag.style.background = 'rgba(197, 48, 48, 0.2)';
                                tag.style.color = 'var(--accent-red)';
                            } else if (risk === 'flood') {
                                tag.style.background = 'rgba(56, 161, 105, 0.2)';
                                tag.style.color = 'var(--accent-green)';
                            } else {
                                tag.style.background = 'rgba(210, 105, 30, 0.2)';
                                tag.style.color = 'var(--accent-orange)';
                            }
                            tag.textContent = risk.charAt(0).toUpperCase() + risk.slice(1);
                            districtRisks.appendChild(tag);
                        });
                        
                        // Add tips
                        let tips = '';
                        if (zone.risks.includes('earthquake')) {
                            tips += '• Secure heavy furniture and know evacuation routes. ';
                        }
                        if (zone.risks.includes('flood')) {
                            tips += '• Prepare emergency supplies and evacuation plan. ';
                        }
                        if (zone.risks.includes('landslide')) {
                            tips += '• Avoid hillside areas during heavy rain. ';
                        }
                        districtTips.textContent = tips || 'Regular emergency preparedness recommended.';
                        
                        districtInfo.style.display = 'block';
                    });
                    
                    // Add to appropriate layers
                    if (zone.risks.includes('earthquake')) riskLayers.earthquake.addLayer(marker);
                    if (zone.risks.includes('flood')) riskLayers.flood.addLayer(marker);
                    if (zone.risks.includes('landslide')) riskLayers.landslide.addLayer(marker);
                    riskLayers.all.addLayer(marker);
                });
                
                // Add all layers by default
                riskLayers.all.addTo(map);
                
                // Add click handler to map to close district info
                map.on('click', function() {
                    document.getElementById('district-info').style.display = 'none';
                });
                
                // Layer control buttons
                document.querySelectorAll('.map-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const layer = this.getAttribute('data-layer');
                        
                        // Update button states
                        document.querySelectorAll('.map-btn').forEach(b => b.classList.remove('active'));
                        this.classList.add('active');
                        
                        // Remove all layers
                        Object.values(riskLayers).forEach(layerGroup => {
                            if (map.hasLayer(layerGroup)) {
                                map.removeLayer(layerGroup);
                            }
                        });
                        
                        // Add selected layer
                        if (layer === 'all') {
                            riskLayers.all.addTo(map);
                        } else {
                            riskLayers[layer].addTo(map);
                        }
                    });
                });
                
                // Make function available globally for popup button
                window.updateWeatherFromMap = function(locationName) {
                    updateWeatherForLocation(locationName);
                };
            }
            
            // Auto-refresh every 5 minutes
            setInterval(() => {
                updateAirQualityData();
                updateFloodAlertData();
                updateWeatherData();
            }, 300000);
            
            // Initialize with home tab active
            switchTab('home');
        });
    </script>
</body>
</html>
